<VirtualHost *:80>
  ServerName ci.hibernate.org
  Redirect permanent / https://ci.hibernate.org/
</VirtualHost>

<IfModule mod_ssl.c>
<VirtualHost *:443>
  ServerName ci.hibernate.org
  ProxyRequests Off
  AllowEncodedSlashes NoDecode
  RequestHeader set X-Forwarded-Proto "https"

  # Local reverse proxy authorization override
  # Most unix distribution deny proxy by default
  <Proxy http://localhost:8080/*>
    Order deny,allow
    Allow from all
  </Proxy>

  ProxyPreserveHost on
  ProxyPass / http://localhost:8080/ nocanon
  ProxyPassReverse / http://localhost:8080/

  # Following 4 lines have been auto-generated by cert-bot:
  SSLCertificateFile /etc/letsencrypt/live/ci.hibernate.org/cert.pem
  SSLCertificateKeyFile /etc/letsencrypt/live/ci.hibernate.org/privkey.pem
  Include /etc/letsencrypt/options-ssl-apache.conf
  SSLCertificateChainFile /etc/letsencrypt/live/ci.hibernate.org/chain.pem

  Header edit Location ^http://ci.hibernate.org https://ci.hibernate.org

</VirtualHost>
</IfModule>
